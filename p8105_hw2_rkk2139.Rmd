---
title: "p8105_hw2_rkk2139"
author: "Riya Kalra"
output: github_document
---
# Problem 1
### Dataset Dimensions
```{r message = FALSE, echo = FALSE}

library(tidyverse)
library(dplyr)
library(readr)
library(readxl)
library(janitor)
library(knitr)


# Read CSV
nyc_transit_data <- read.csv("https://p8105.com/data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") |> 
view()

# Clean data
transit_df <- nyc_transit_data %>%
  select(Line, Station.Name, Station.Latitude, Station.Longitude, Route1:Route11, Entry, Vending, Entrance.Type, ADA) %>%
  
# Convert Entry from YES/NO to TRUE/FALSE
mutate(Entry = ifelse(Entry == "YES", TRUE, FALSE))

# Get dimensions of cleaned dataset
dataset_dimensions <- dim(transit_df)

# transit_df
dataset_dimensions

```
For data to be tidy, each variable should form a column, and each observation should form a row. Based on the inconsistencies in the data, like the routes, or the use of "Yes" and "True" interchangeably, and redundancy of column, the data is not tidy.

### How many distinct stations are there?
```{r, echo = FALSE}
# Count distinct stations by name and line
distinct_stations <- transit_df %>%
  distinct(Station.Name, Line) %>%
  nrow()

distinct_stations
```
### How many stations are ADA compliant?
```{r, echo = FALSE}
ada_compliant_stations <- transit_df %>%
  filter(ADA == TRUE) %>%
  distinct(Station.Name, Line) %>%
  nrow()

ada_compliant_stations
```

### What proportion of station entrances/exits without vending allow entrance?
```{r, echo = FALSE, message = FALSE}
no_vending_proportion <- transit_df %>%
  filter(Vending == "NO") %>%
  summarise(proportion = mean(Entry, na.rm = TRUE)) %>%
  pull(proportion)

no_vending_proportion
```


```{r, echo = FALSE}
# Combine route columns into a single column
transit_df <- transit_df %>%
  unite("Routes", Route1:Route11, sep = ",", na.rm = TRUE, remove = TRUE)

# Separate the "Routes" column into distinct rows
transit_df_expanded <- transit_df %>%
  separate_rows(Routes, sep = ",")

head(transit_df_expanded)
```
### How many distinct stations serve the A train?
```{r, echo = FALSE}
a_train_stations <- transit_df_expanded %>%
  filter(Routes == "A") %>%
  distinct(Station.Name, Line) %>%
  nrow()
a_train_stations
```
### Of the stations that serve the A train, how many are ADA compliant?
```{r, echo = FALSE}
a_train_ada_compliant <- transit_df_expanded %>%
  filter(Routes == "A", ADA == TRUE) %>%
  distinct(Station.Name, Line) %>%
  nrow()
a_train_ada_compliant
```

# Problem 2


```{r echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
#Function to clean and read each sheet: omit irrelevant rows, round sports balls

read_sheets = function(sheet_name) {
  sheet_data <-
    read_excel("datasets/202409 Trash Wheel Collection Data.xlsx",
               sheet = sheet_name,
               na = c("NA", ".", ""),
               skip = 1) #skip picture row
  sheet_data <- sheet_data |>
  janitor::clean_names() |>
  select(!homes_powered) |> #column is not related to dumpster data
  filter(!is.na(dumpster))

  #return(sheet_data)
}

mr_trash_wheel = read_sheets("Mr. Trash Wheel") |>
  select(-x15, -x16) |> #remove NA
  mutate( 
    #clean up variable types and add new column
    trash_wheel_label = "Mr. Trash Wheel", 
    year = as.numeric(year),
    sports_balls = as.integer(round(sports_balls))
  )

prof_trash_wheel = read_sheets("Professor Trash Wheel") |>
  mutate(trash_wheel_label = "Professor Trash Wheel") |>
  filter(dumpster != 119)

gwyn_trash_wheel = read_sheets("Gwynnda Trash Wheel") |>
  mutate(trash_wheel_label = "Gwynnda Trash Wheel")
```

```{r, echo = FALSE, results = 'hide'}
# combine datasets
trash_wheel_df = 
  bind_rows(mr_trash_wheel, prof_trash_wheel, gwyn_trash_wheel) |>
  relocate(trash_wheel_label)
```


```{r echo = FALSE, results = 'hide', message = FALSE}
# count
mr_count = 
  trash_wheel_df |>
  filter(trash_wheel_label == "Mr. Trash Wheel")
  #nrow()

prof_count = 
  trash_wheel_df |>
  filter(trash_wheel_label == "Professor Trash Wheel")
  #nrow()

gwyn_count = 
  trash_wheel_df |>
  filter(trash_wheel_label == "Gwynnda Trash Wheel")
  #nrow()
```

```{r, echo = FALSE}
#head(mr_trash_wheel)
#view(prof_trash_wheel)

#head(trash_wheel_df)
#view(trash_wheel_df)


cat("Dimensions of Mr. Trash Wheel data:", dim(mr_trash_wheel), "\n")
cat("Dimensions of Professor Trash Wheel data:", dim(prof_trash_wheel), "\n")
cat("Dimensions of Gwynnda Trash Wheel data:", dim(gwyn_trash_wheel), "\n")
cat("Dimensions of combined Trash Wheel data:", dim(trash_wheel_df), "\n")

```

### Observations and Key Variables

The observations in the resulting dataset total 1032 rows, and include the data from the three different datasets, Gwynnda, Mr. Trash Wheel, and Professor Trash Wheel. Key variables include `weight_tons` and `volume_cubic_yards`, which are used for measuring the amount of trash. Additionally, the variables `cigarette_butts`, `plastic_bottles`, and others that detail the type of trash, provide information about how much of the total trash was comprised of which trash item.

```{r, echo = FALSE}
prof_trash_weight_total= trash_wheel_df |> filter(trash_wheel_label == "Professor Trash Wheel") |> summarise(total_weight = sum(weight_tons, na.rm = TRUE))
gwyn_cigs_total = trash_wheel_df |> filter(trash_wheel_label == "Gwynnda Trash Wheel" & year == 2022 & month == "June") |> summarise(gwyn_cigs_total = sum(cigarette_butts, na.rm = TRUE))
gwyn_cigs_total <- gwyn_cigs_total[[1]]

```

The total weight of trash collected by Professor Trash Wheel was `r prof_trash_weight_total`. The total number of cigarette butts collected by Gwynnda in June of 2022 was `r format(gwyn_cigs_total, scientific = FALSE)`.


